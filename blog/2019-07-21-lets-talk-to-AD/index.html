<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.4162a12c277452799507.css">.navbar .navbar-menu{box-shadow:none!important}.content .taglist{list-style:none;margin:1.5rem 1.5rem 0 0;display:flex;flex-wrap:wrap;justify-content:left;align-items:center}.content .taglist li{padding:0 2rem 1rem 0;margin-bottom:1.5rem;margin-top:0}.full-width-image-container{position:relative;left:50%;right:50%;margin:2em -50vw}.full-width-image,.full-width-image-container{width:100vw;height:400px;background-size:cover;background-position:bottom;display:flex;justify-content:center;align-items:center}.btn{display:inline-block;padding:12px 16px 10px;font-size:18px;font-size:1rem;line-height:1.25;background-color:#fff;border-radius:.25rem;text-decoration:none;font-weight:700;color:#cc3700;text-align:center;box-shadow:inset 0 0 0 2px #f40;transition:all .15s ease}.margin-top-0{margin-top:0!important}.navbar-item .icon{color:#d64000}.icon svg{width:1.5rem;height:1.5rem;fill:currentColor}.navbar-brand .navbar-item.logo{padding:0 1rem}footer.footer{padding:3rem 0 0;background-color:transparent}.menu-list{list-style:none!important;text-align:left}.social{padding:2em}.social a{padding:.5em .5em .3em;border-radius:1em;background-color:#f5f5f5;margin:.5em;width:1em;height:1em;vertical-align:middle;display:inline}.blog-list-item.is-featured{background-color:rgba(214,64,0,.2)}.blog-list-item header{display:flex;margin-bottom:1em}.blog-list-item .featured-thumbnail{flex-basis:35%;margin:0 1.5em 0 0}

/*! bulma.io v0.7.5 | MIT License | github.com/jgthms/bulma */@keyframes spinAround{0%{transform:rotate(0deg)}to{transform:rotate(359deg)}}.button,.file{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.box:not(:last-child),.content:not(:last-child),.message:not(:last-child),.notification:not(:last-child),.subtitle:not(:last-child),.title:not(:last-child){margin-bottom:1.5rem}.button,.file-cta,.input,.textarea{-moz-appearance:none;-webkit-appearance:none;align-items:center;border:1px solid transparent;border-radius:4px;box-shadow:none;display:inline-flex;font-size:1rem;height:2.25em;justify-content:flex-start;line-height:1.5;padding:calc(.375em - 1px) calc(.625em - 1px);position:relative;vertical-align:top}.button:active,.button:focus,.file-cta:active,.file-cta:focus,.input:active,.input:focus,.is-active.button,.is-active.file-cta,.is-active.input,.is-active.textarea,.textarea:active,.textarea:focus{outline:none}.button[disabled],.file-cta[disabled],.input[disabled],.textarea[disabled]{cursor:not-allowed}

/*! minireset.css v0.0.4 | MIT License | github.com/jgthms/minireset.css */body,h1,h2,h3,h4,html,legend,li,p,textarea,ul{margin:0;padding:0}h1,h2,h3,h4{font-size:100%;font-weight:400}ul{list-style:none}button,input,textarea{margin:0}html{box-sizing:border-box}*,:after,:before{box-sizing:inherit}img,object{height:auto;max-width:100%}html{background-color:#fff;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;min-width:300px;overflow-x:hidden;overflow-y:scroll;text-rendering:optimizeLegibility;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;text-size-adjust:100%}article,footer,header,section{display:block}body,button,input,textarea{font-family:BlinkMacSystemFont,-apple-system,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif}code{-moz-osx-font-smoothing:auto;-webkit-font-smoothing:auto;font-family:monospace}body{color:#333;font-size:1em;font-weight:400;line-height:1.5}a{color:#3273dc;cursor:pointer;text-decoration:none}a strong{color:currentColor}a:hover{color:#363636}code{background-color:#f5f5f5;color:#ff3860;font-size:.875em;font-weight:400;padding:.25em .5em}img{height:auto;max-width:100%}input[type=checkbox],input[type=radio]{vertical-align:baseline}span{font-style:inherit;font-weight:inherit}strong{color:#363636;font-weight:700}.is-size-1{font-size:3rem!important}.is-size-2{font-size:2.5rem!important}.is-size-3{font-size:2rem!important}.is-size-4{font-size:1.5rem!important}.is-size-5{font-size:1.25rem!important}@media screen and (max-width:768px){.is-size-3-mobile{font-size:2rem!important}}@media print,screen and (min-width:769px){.is-size-2-tablet{font-size:2.5rem!important}}@media screen and (min-width:1216px){.is-size-1-widescreen{font-size:3rem!important}}.has-text-centered{text-align:center!important}.has-background-black{background-color:#2b2523!important}.has-text-primary{color:#d64000!important}a.has-text-primary:focus,a.has-text-primary:hover{color:#a33100!important}.has-text-white-ter{color:#f5f5f5!important}.has-text-weight-semibold{font-weight:600!important}.has-text-weight-bold{font-weight:700!important}.is-block{display:block!important}.box{background-color:#fff;border-radius:6px;box-shadow:0 2px 3px rgba(43,37,35,.1),0 0 0 1px rgba(43,37,35,.1);color:#4a4a4a;display:block;padding:1.25rem}a.box:focus,a.box:hover{box-shadow:0 2px 3px rgba(43,37,35,.1),0 0 0 1px #3273dc}a.box:active{box-shadow:inset 0 1px 2px rgba(43,37,35,.2),0 0 0 1px #3273dc}.button{background-color:#fff;border-color:#dbdbdb;border-width:1px;color:#363636;cursor:pointer;justify-content:center;padding:calc(.375em - 1px) .75em;text-align:center;white-space:nowrap}.button strong{color:inherit}.button .icon{height:1.5em;width:1.5em}.button .icon:first-child:not(:last-child){margin-left:calc(-.375em - 1px);margin-right:.1875em}.button .icon:last-child:not(:first-child){margin-left:.1875em;margin-right:calc(-.375em - 1px)}.button .icon:first-child:last-child{margin-left:calc(-.375em - 1px);margin-right:calc(-.375em - 1px)}.button:hover{border-color:#b5b5b5;color:#363636}.button:focus{border-color:#3273dc;color:#363636}.button:focus:not(:active){box-shadow:0 0 0 .125em rgba(50,115,220,.25)}.button.is-active,.button:active{border-color:#4a4a4a;color:#363636}.button.is-link{background-color:#3273dc;border-color:transparent;color:#fff}.button.is-link:hover{background-color:#276cda}.button.is-link:focus,.button.is-link:hover{border-color:transparent;color:#fff}.button.is-link:focus:not(:active){box-shadow:0 0 0 .125em rgba(50,115,220,.25)}.button.is-link.is-active,.button.is-link:active{background-color:#2366d1;border-color:transparent;color:#fff}.button.is-link[disabled]{background-color:#3273dc;border-color:transparent;box-shadow:none}.button[disabled]{background-color:#fff;border-color:#dbdbdb;box-shadow:none;opacity:.5}.container{flex-grow:1;margin:0 auto;position:relative;width:auto}@media screen and (min-width:1024px){.container{max-width:960px}}@media screen and (min-width:1216px){.container{max-width:1152px}}@media screen and (min-width:1408px){.container{max-width:1344px}}.content li+li{margin-top:.25em}.content p:not(:last-child),.content ul:not(:last-child){margin-bottom:1em}.content h1,.content h2,.content h3,.content h4{color:#363636;font-weight:600;line-height:1.125}.content h1{font-size:2em;margin-bottom:.5em}.content h1:not(:first-child){margin-top:1em}.content h2{font-size:1.75em;margin-bottom:.5714em}.content h2:not(:first-child){margin-top:1.1428em}.content h3{font-size:1.5em;margin-bottom:.6666em}.content h3:not(:first-child){margin-top:1.3333em}.content h4{font-size:1.25em;margin-bottom:.8em}.content ul{list-style:disc outside;margin-left:2em;margin-top:1em}.content ul ul{list-style-type:circle;margin-top:.5em}.content ul ul ul{list-style-type:square}.icon{align-items:center;display:inline-flex;justify-content:center;height:1.5rem;width:1.5rem}.image{display:block;position:relative}.image img{display:block;height:auto;width:100%}.notification{background-color:#f5f5f5;border-radius:4px;padding:1.25rem 2.5rem 1.25rem 1.5rem;position:relative}.notification a:not(.button):not(.dropdown-item){color:currentColor;text-decoration:underline}.notification strong{color:currentColor}.notification code{background:#fff}.notification .content,.notification .subtitle,.notification .title{color:currentColor}.notification.is-link{background-color:#3273dc;color:#fff}@keyframes moveIndeterminate{0%{background-position:200% 0}to{background-position:-200% 0}}.tags{align-items:center;display:flex;flex-wrap:wrap;justify-content:flex-start}.tags .tag{margin-bottom:.5rem}.tags .tag:not(:last-child){margin-right:.5rem}.tags:last-child{margin-bottom:-.5rem}.tags:not(:last-child){margin-bottom:1rem}.tag:not(body){align-items:center;background-color:#f5f5f5;border-radius:4px;color:#4a4a4a;display:inline-flex;font-size:.75rem;height:2em;justify-content:center;line-height:1.5;padding-left:.75em;padding-right:.75em;white-space:nowrap}.tag:not(body).is-link{background-color:#3273dc;color:#fff}.tag:not(body) .icon:first-child:not(:last-child){margin-left:-.375em;margin-right:.1875em}.tag:not(body) .icon:last-child:not(:first-child){margin-left:.1875em;margin-right:-.375em}.tag:not(body) .icon:first-child:last-child{margin-left:-.375em;margin-right:-.375em}a.tag:hover{text-decoration:underline}.subtitle,.title{word-break:break-word}.subtitle span,.title span{font-weight:inherit}.subtitle .tag,.title .tag{vertical-align:middle}.title{color:#363636;font-size:2rem;font-weight:600;line-height:1.125}.title strong{color:inherit;font-weight:inherit}.title:not(.is-spaced)+.subtitle{margin-top:-1.25rem}.title.is-4{font-size:1.5rem}.title.is-6{font-size:1rem}.subtitle{color:#4a4a4a;font-size:1.25rem;font-weight:400;line-height:1.25}.subtitle strong{color:#363636;font-weight:600}.subtitle:not(.is-spaced)+.title{margin-top:-1.25rem}.subtitle.is-4{font-size:1.5rem}.subtitle.is-6{font-size:1rem}.heading{display:block;font-size:11px;letter-spacing:1px;margin-bottom:5px;text-transform:uppercase}.input,.textarea{background-color:#fff;border-color:#dbdbdb;border-radius:4px;color:#363636}.input::-moz-placeholder,.textarea::-moz-placeholder{color:rgba(54,54,54,.3)}.input::-webkit-input-placeholder,.textarea::-webkit-input-placeholder{color:rgba(54,54,54,.3)}.input:-moz-placeholder,.textarea:-moz-placeholder{color:rgba(54,54,54,.3)}.input:-ms-input-placeholder,.textarea:-ms-input-placeholder{color:rgba(54,54,54,.3)}.input:hover,.textarea:hover{border-color:#b5b5b5}.input:active,.input:focus,.is-active.input,.is-active.textarea,.textarea:active,.textarea:focus{border-color:#3273dc;box-shadow:0 0 0 .125em rgba(50,115,220,.25)}.input[disabled],.textarea[disabled]{background-color:#f5f5f5;border-color:#f5f5f5;box-shadow:none;color:#7a7a7a}.input[disabled]::-moz-placeholder,.textarea[disabled]::-moz-placeholder{color:hsla(0,0%,47.8%,.3)}.input[disabled]::-webkit-input-placeholder,.textarea[disabled]::-webkit-input-placeholder{color:hsla(0,0%,47.8%,.3)}.input[disabled]:-moz-placeholder,.textarea[disabled]:-moz-placeholder{color:hsla(0,0%,47.8%,.3)}.input[disabled]:-ms-input-placeholder,.textarea[disabled]:-ms-input-placeholder{color:hsla(0,0%,47.8%,.3)}.input,.textarea{box-shadow:inset 0 1px 2px rgba(43,37,35,.1);max-width:100%;width:100%}.input[readonly],.textarea[readonly]{box-shadow:none}.is-link.input,.is-link.textarea{border-color:#3273dc}.is-link.input:active,.is-link.input:focus,.is-link.is-active.input,.is-link.is-active.textarea,.is-link.textarea:active,.is-link.textarea:focus{box-shadow:0 0 0 .125em rgba(50,115,220,.25)}.textarea{display:block;max-width:100%;min-width:100%;padding:.625em;resize:vertical}.textarea:not([rows]){max-height:600px;min-height:120px}.textarea[rows]{height:auto}.file{align-items:stretch;display:flex;justify-content:flex-start;position:relative}.file.is-link .file-cta{background-color:#3273dc;border-color:transparent;color:#fff}.file.is-link:hover .file-cta{background-color:#276cda;border-color:transparent;color:#fff}.file.is-link:focus .file-cta{border-color:transparent;box-shadow:0 0 .5em rgba(50,115,220,.25);color:#fff}.file.is-link.is-active .file-cta,.file.is-link:active .file-cta{background-color:#2366d1;border-color:transparent;color:#fff}.file-label{align-items:stretch;display:flex;cursor:pointer;justify-content:flex-start;overflow:hidden;position:relative}.file-label:hover .file-cta{background-color:#eee;color:#363636}.file-label:active .file-cta{background-color:#e8e8e8;color:#363636}.file-input{height:100%;left:0;opacity:0;outline:none;position:absolute;top:0;width:100%}.file-cta{border-color:#dbdbdb;border-radius:4px;font-size:1em;padding-left:1em;padding-right:1em;white-space:nowrap;background-color:#f5f5f5;color:#4a4a4a}.label{color:#363636;display:block;font-size:1rem;font-weight:700}.label:not(:last-child){margin-bottom:.5em}.field:not(:last-child){margin-bottom:.75rem}.control{box-sizing:border-box;clear:both;position:relative;text-align:left}.control,.menu{font-size:1rem}.menu-list{line-height:1.25}.menu-list a{border-radius:2px;color:#f5f5f5;display:block;padding:.5em .75em}.menu-list a:hover{background-color:#2b2523;color:#2b2523!important}.menu-list a.is-active{background-color:#fff;color:#fff}.menu-list li ul{border-left:1px solid #fff;margin:.75em;padding-left:.75em}.message{background-color:#f5f5f5;border-radius:4px;font-size:1rem}.message strong{color:currentColor}.message a:not(.button):not(.tag):not(.dropdown-item){color:currentColor;text-decoration:underline}.message.is-link{background-color:#f6f9fe}.message.is-link .message-body{border-color:#3273dc;color:#22509a}.message-body{border-radius:4px;border:solid #dbdbdb;border-width:0 0 0 4px;color:#4a4a4a;padding:1.25em 1.5em}.message-body code,.navbar{background-color:#fff}.navbar{min-height:3.25rem;position:relative;z-index:30}.navbar.is-link{background-color:#3273dc;color:#fff}.navbar.is-link .navbar-brand>.navbar-item{color:#fff}.navbar.is-link .navbar-brand>a.navbar-item.is-active,.navbar.is-link .navbar-brand>a.navbar-item:focus,.navbar.is-link .navbar-brand>a.navbar-item:hover{background-color:#2366d1;color:#fff}.navbar.is-link .navbar-burger{color:#fff}@media screen and (min-width:1024px){.navbar.is-link .navbar-start>.navbar-item{color:#fff}.navbar.is-link .navbar-start>a.navbar-item.is-active,.navbar.is-link .navbar-start>a.navbar-item:focus,.navbar.is-link .navbar-start>a.navbar-item:hover{background-color:#2366d1;color:#fff}}.navbar>.container{width:100%}.navbar-brand,.navbar>.container{align-items:stretch;display:flex;min-height:3.25rem}.navbar-brand{flex-shrink:0}.navbar-brand a.navbar-item:focus,.navbar-brand a.navbar-item:hover{background-color:transparent}.navbar-burger{color:#4a4a4a;cursor:pointer;display:block;height:3.25rem;position:relative;width:3.25rem;margin-left:auto}.navbar-burger span{background-color:currentColor;display:block;height:1px;left:calc(50% - 8px);position:absolute;transform-origin:center;transition-duration:86ms;transition-property:background-color,opacity,transform;transition-timing-function:ease-out;width:16px}.navbar-burger span:first-child{top:calc(50% - 6px)}.navbar-burger span:nth-child(2){top:calc(50% - 1px)}.navbar-burger span:nth-child(3){top:calc(50% + 4px)}.navbar-burger:hover{background-color:rgba(0,0,0,.05)}.navbar-burger.is-active span:first-child{transform:translateY(5px) rotate(45deg)}.navbar-burger.is-active span:nth-child(2){opacity:0}.navbar-burger.is-active span:nth-child(3){transform:translateY(-5px) rotate(-45deg)}.navbar-menu{display:none}.navbar-item{color:#4a4a4a;line-height:1.5;padding:.5rem .75rem;position:relative}.navbar-item .icon:only-child{margin-left:-.25rem;margin-right:-.25rem}a.navbar-item{cursor:pointer}a.navbar-item.is-active,a.navbar-item:focus,a.navbar-item:focus-within,a.navbar-item:hover{background-color:#fafafa;color:#3273dc}.navbar-item{display:block;flex-grow:0;flex-shrink:0}.navbar-item img{max-height:1.75rem}@media screen and (max-width:1023px){.navbar>.container{display:block}.navbar-brand .navbar-item{align-items:center;display:flex}.navbar-menu{background-color:#fff;box-shadow:0 8px 16px rgba(43,37,35,.1);padding:.5rem 0}.navbar-menu.is-active{display:block}}@media screen and (min-width:1024px){.navbar,.navbar-menu,.navbar-start{align-items:stretch;display:flex}.navbar{min-height:3.25rem}.navbar.is-transparent a.navbar-item.is-active,.navbar.is-transparent a.navbar-item:focus,.navbar.is-transparent a.navbar-item:hover{background-color:transparent!important}.navbar-burger{display:none}.navbar-item{align-items:center;display:flex}.navbar-menu{flex-grow:1;flex-shrink:0}.navbar-start{justify-content:flex-start;margin-right:auto}.container>.navbar .navbar-brand,.navbar>.container .navbar-brand{margin-left:-.75rem}.container>.navbar .navbar-menu,.navbar>.container .navbar-menu{margin-right:-.75rem}a.navbar-item.is-active{color:#2b2523}a.navbar-item.is-active:not(:focus):not(:hover){background-color:transparent}}.column{display:block;flex-basis:0;flex-grow:1;flex-shrink:1;padding:.75rem}@media print,screen and (min-width:769px){.column.is-offset-1{margin-left:8.33333%}.column.is-4{flex:none;width:33.33333%}.column.is-6{flex:none;width:50%}.column.is-10{flex:none;width:83.33333%}.column.is-12{flex:none;width:100%}}.columns{margin-left:-.75rem;margin-right:-.75rem;margin-top:-.75rem}.columns:last-child{margin-bottom:-.75rem}.columns:not(:last-child){margin-bottom:.75rem}.columns.is-multiline{flex-wrap:wrap}@media print,screen and (min-width:769px){.columns:not(.is-desktop){display:flex}}.tile{align-items:stretch;display:block;flex-basis:0;flex-grow:1;flex-shrink:1;min-height:-webkit-min-content;min-height:-moz-min-content;min-height:min-content}.tile.is-child{margin:0!important}.tile.is-parent{padding:.75rem}@media print,screen and (min-width:769px){.tile:not(.is-child){display:flex}.tile.is-4{flex:none;width:33.33333%}.tile.is-6{flex:none;width:50%}.tile.is-10{flex:none;width:83.33333%}.tile.is-12{flex:none;width:100%}}.section{padding:3rem 1.5rem}.footer{background-color:#fafafa;padding:3rem 1.5rem 6rem}@media screen and (min-width:769px) and (max-width:1023px){.blog-list-item .featured-thumbnail{flex-basis:50%}}@media screen and (max-width:768px){.blog-list-item header{display:block}.blog-list-item .featured-thumbnail{text-align:center;max-width:70%;margin:0 0 1em}}</style><meta name="generator" content="Gatsby 2.13.31"/><title data-react-helmet="true">Let&#x27;s talk to Active Directory | Blog</title><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png"/><link data-react-helmet="true" rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32"/><link data-react-helmet="true" rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16"/><link data-react-helmet="true" rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#ff4400"/><meta data-react-helmet="true" name="theme-color" content="#fff"/><meta data-react-helmet="true" property="og:type" content="business.business"/><meta data-react-helmet="true" property="og:title" content="Portfolio"/><meta data-react-helmet="true" property="og:url" content="/"/><meta data-react-helmet="true" property="og:image" content="/img/og-image.jpg"/><meta data-react-helmet="true" name="description" content="When you need to find out info about your users and groups"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><link as="script" rel="preload" href="/webpack-runtime-d2d979d476131837bff3.js"/><link as="script" rel="preload" href="/app-c854117d53b9eb1ae65e.js"/><link as="script" rel="preload" href="/styles-65d0eb307115056d1679.js"/><link as="script" rel="preload" href="/1-be23e6ea5d5e37b03898.js"/><link as="script" rel="preload" href="/2-9e3778d7061052ade4c2.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-7f8a571ae5734db95f50.js"/><link as="fetch" rel="preload" href="/page-data/blog/2019-07-21-lets-talk-to-AD/page-data.json" crossorigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div><nav class="navbar is-transparent" role="navigation" aria-label="main-navigation"><div class="container"><div class="navbar-brand"><a class="navbar-item" title="Logo" href="/">Home</a><div class="navbar-burger burger " data-target="navMenu"><span></span><span></span><span></span></div></div><div id="navMenu" class="navbar-menu "><div class="navbar-start has-text-centered"><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/blog">Blog</a></div></div></div></nav><div><section class="section"><div class="container content"><div class="columns"><div class="column is-10 is-offset-1"><h1 class="title is-size-2 has-text-weight-bold is-bold-light">Let&#x27;s talk to Active Directory</h1><p>When you need to find out info about your users and groups</p><div><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 96px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/fa0b4d3aef91335419c7f295c9ac6f83/31c9d/System.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 316.6666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAA/ABQDASIAAhEBAxEB/8QAGQAAAwEBAQAAAAAAAAAAAAAAAAECAwQF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB9paIk0BznB0iAm5KAMWZjNA//8QAHRAAAgIDAAMAAAAAAAAAAAAAAAEREgIQIRMiMf/aAAgBAQABBQJuCyHlB09hKNTrI6L5EixW09SWPJUySFRlUz//xAAUEQEAAAAAAAAAAAAAAAAAAAAw/9oACAEDAQE/AQ//xAAUEQEAAAAAAAAAAAAAAAAAAAAw/9oACAECAQE/AQ//xAAgEAACAQQBBQAAAAAAAAAAAAAAASECESIyIDAxQWGR/9oACAEBAAY/ApTZq/hYg8Lj3dyXUl76GsmjJRKujGkyln//xAAgEAEAAgEFAAMBAAAAAAAAAAABABExECFBUXFhkaHx/9oACAEBAAE/IRo2HRctrki3a2UMjxm7+kARQzAee6WuwOhzCztDoTHcRkXA71v86LWYDh0vlTwink+onYh7OhH5LWZJmAh//9oADAMBAAIAAwAAABDDBzDzwDz/xAAUEQEAAAAAAAAAAAAAAAAAAAAw/9oACAEDAQE/EA//xAAUEQEAAAAAAAAAAAAAAAAAAAAw/9oACAECAQE/EA//xAAhEAEAAQQBBAMAAAAAAAAAAAABEQAhMWFBEFFxkYGhwf/aAAgBAQABPxCToMyoNaqJDlWZHn1QuEGEpZMTsW+Kt8XclflRglVlXK1nUTjdYzKW0En30FoR4WHzTfKEqAdU1QJOJzHH1RUENlKEKGylj30ASgN0fAr2noXrGIkv4vx+1ETbTp90xOshlFCBMlnkbKIAdaI91eMGWLGiv//Z'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="System"
        title="System"
        src="/static/fa0b4d3aef91335419c7f295c9ac6f83/31c9d/System.jpg"
        srcset="/static/fa0b4d3aef91335419c7f295c9ac6f83/31c9d/System.jpg 96w"
        sizes="(max-width: 96px) 100vw, 96px"
      />
  </a>
    </span></p>
<h2>The project at hand</h2>
<p>We need to be able to do a list of operations that talk to active directory.</p>
<ul>
<li>List groups found active directory</li>
<li>List users from a given group</li>
<li>Quickly check if a user is a group member</li>
</ul>
<h2>The how</h2>
<p>For this process we're going to talk to the Microsoft graph, for the purposes of this post everything is already setup so that groups and users can be found within it.</p>
<ol>
<li>
<p>Obtain a bearer token</p>
<pre><code class="language-javascript">const rootLogin = `https://login.microsoftonline.com/arup.onmicrosoft.com/oauth2/v2.0/token`

const params = {
  grant_type: 'client_credentials',
  client_id:
    process.env['waad_client_id'] || '',
  client_secret:
    process.env['waad_client_secret'] ||
    '',
  scope: 'https://graph.microsoft.com/.default',
}

const encodedUrlParams = Object.keys(params)
  .map(key => key + '=' + params[key])
  .join('&#x26;')

const content_type = 'application/x-www-form-urlencoded'
const getAccessToken = async () => {
  return fetch(rootLogin, {
    headers: { 'Content-Type': content_type },
    method: 'POST',
    body: encodedUrlParams,
  })
    .then(body => body.json())
    .then(json =>
      json
        ? `${json.token_type} ${json.access_token}`
        : new Error('Failed to retrieve token')
    )
    .catch(console.log)
}
</code></pre>
<p>We need to talk to the oauth api and hand over our <code>client_id</code> and <code>client_secret</code>, in return we get a time limited Bearer token to request data.</p>
</li>
<li>
<p>Get a list of groups</p>
<pre><code class="language-javascript">export const getADGroups = async name => {
  if (!access_token) {
    access_token = await getAccessToken()
  }
  const groupResults = await fetch(
    `https://graph.microsoft.com/v1.0/groups?$top=10&#x26;$filter=startsWith(displayName, '${name}')&#x26;$select=id,displayName&#x26;$format=json`,
    {
      method: 'GET',
      headers: { Authorization: access_token },
    }
  )
    .then(body => body.json())
    .catch(console.log)
  const groups = groupResults &#x26;&#x26; groupResults.value
  return groups
}
</code></pre>
<p>For our use case we are searching by the start of the group name, and restricting our search to the top 10 results.</p>
</li>
<li>
<p>Pagination!</p>
<pre><code class="language-javascript">const getAllPages = async (pages, pageResults) => {
  if (!access_token) {
    access_token = await getAccessToken()
  }
  // Store results into pages
  // If nextLink call getADpages with new link
  // Repeat till nextLink doesnt exist then return
  pages = pages.concat(pageResults.value)
  if (pageResults &#x26;&#x26; typeof pageResults['@odata.nextLink'] === 'string') {
    const page_results = await fetch(pageResults['@odata.nextLink'], {
      method: 'GET',
      headers: { Authorization: access_token },
    }).then(body => body.json())

    pages = getAllPages(pages, page_results)
  }
  return pages
}

const getNPages = async (pages, pageResults, n) => {
  if (!access_token) {
    access_token = await getAccessToken()
  }
  // Store results into pages
  // If nextLink call getADpages with new link
  // Repeat till nextLink doesnt exist then return
  pages = pages.concat(pageResults.value)
  if (n > 0) {
    if (pageResults &#x26;&#x26; typeof pageResults['@odata.nextLink'] === 'string') {
      const page_results = await fetch(pageResults['@odata.nextLink'], {
        method: 'GET',
        headers: { Authorization: access_token },
      })
        .then(body => body.json())
        .catch(err => console.log(err))
      pages = getNPages(pages, page_results, n - 1)
    }
  }
  return pages
}
</code></pre>
<p>  We need some helper functions to paginate through the returned results when the number of members > 100
the graph api will return a property <code>@odata.nextLink</code> which contains a url to retrieve the next batch.</p>
<p>  We have two helper functions, the first will keep going till the property is no longer present (very slow, many http requests)
The second takes a <code>n</code> parameter describing the level of recursion it should go to, this avoids it getting stuck in an infinite recursion loop (hopefully) and speeds things up.</p>
</li>
<li>
<p>Get group members</p>
<pre><code class="language-javascript">export const getADGroupMembers = async groupId => {
  if (!access_token) {
    access_token = await getAccessToken()
  }
  const groupResults = await fetch(
    `https://graph.microsoft.com/v1.0/groups/${groupId}/transitiveMembers?$filter@odata.type eq '#microsoft.graph.user'`,
    {
      method: 'GET',
      headers: { Authorization: access_token },
    }
  )
    .then(body => body.json())
    .catch(console.log)
  let members = []
  members = await getAllPages(members, groupResults)
  return members
}
</code></pre>
<p>  Grabs all the group members using the first pagination helper function.</p>
<pre><code class="language-javascript">export const getNPagesADGroupMembers = async (groupId, numPages) => {
  if (!access_token) {
    access_token = await getAccessToken()
  }
  const groupResults = await fetch(
    `https://graph.microsoft.com/v1.0/groups/${groupId}/transitiveMembers`,
    {
      method: 'GET',
      headers: { Authorization: access_token },
    }
  )
    .then(body => body.json())
    .catch(console.log)
  let members = []
  members = await getNPages(members, groupResults, numPages - 1)
  members = members.filter(
    member => member['@odata.type'] === '#microsoft.graph.user'
  )
  return members
}
</code></pre>
<p>  Grab the first n pages of the group members using the second pagination helper function.</p>
</li>
<li>
<p>Check group membership for a single user and a list of groups</p>
<pre><code class="language-javascript">export const checkADGroupMembership = async (ad_groups, email) => {
  if (!access_token) {
    access_token = await getAccessToken()
  }

  const groupResults = await fetch(
    `https://graph.microsoft.com/v1.0/users/${email}/checkMemberGroups`,
    {
      method: 'POST',
      headers: {
        Authorization: access_token,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ groupIds: ad_groups }),
    }
  )
    .then(body => body.json())
    .catch(console.log)
  return groupResults &#x26;&#x26; groupResults.value
}
</code></pre>
<p>Here we pass a list of group id's and a single email address, this uses a built in function
in Microsoft graph and returns the <code>group_id's</code> the email is a member of.</p>
</li>
</ol>
<h2>Make it fast</h2>
<p>The microsoft graph API is...slow (understandably), for anything more then a single call we will be waiting
multiple seconds, for the cases of pagination where we might be fetching 5+ pages of users from a group
where each call takes 1+ seconds this quickly adds up.</p>
<p>So what we're going to do is stick redis in front of our calls to the graph with a 3600 second expiry time.
This way our most popular calls are not hitting the graph each time, we only pay the penalty once.</p>
<pre><code>  Pre redis
  ✓ Searching specific group (3038ms)
  ✓ Searching specific group - case insensitive (625ms)
  ✓ Fetching group and its members (2106ms)
  ✓ Check AD group membership (942ms)
  ✓ Get N pages of users (3777ms)

  Post redis
  ✓ Searching specific group (19ms)
  ✓ Searching specific group - case insensitive (11ms)
  ✓ Fetching group and its members (6ms)
  ✓ Check AD group membership (1ms)
  ✓ Get N pages of users (3ms)
</code></pre>
<h2>TADA</h2>
<p>We've accomplished the tasks we set out to do, a good way to talk to Active Directory without
needing to be on premise.</p>
<p>This allows project managers to setup a single group in active directory and reuse it elsewhere
no further setup needed.</p></div><div style="margin-top:4rem"><h4>Tags</h4><ul class="taglist"><li><a href="/tags/node/">node</a></li><li><a href="/tags/active-directory/">active directory</a></li></ul></div></div></div></div></section></div><footer class="footer has-background-black has-text-white-ter"><div class="content has-text-centered has-background-black has-text-white-ter"><div class="container has-background-black has-text-white-ter"><div class="columns"><div class="column is-4"><section class="menu"><ul class="menu-list"><li><a class="navbar-item" href="/">Home</a></li><li><a class="navbar-item" href="/about">About</a></li></ul></section></div><div class="column is-4"><section><ul class="menu-list"><li><a class="navbar-item" href="/blog">Latest Stories</a></li></ul></section></div><div class="column is-4 social"><a title="facebook" href="https://facebook.com"><img src="data:image/svg+xml;base64,PHN2ZyByb2xlPSJpbWciIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48dGl0bGU+RmFjZWJvb2sgaWNvbjwvdGl0bGU+PHBhdGggZD0iTTIyLjY3NiAwSDEuMzI0Qy41OTMgMCAwIC41OTMgMCAxLjMyNHYyMS4zNTJDMCAyMy40MDguNTkzIDI0IDEuMzI0IDI0aDExLjQ5NHYtOS4yOTRIOS42ODl2LTMuNjIxaDMuMTI5VjguNDFjMC0zLjA5OSAxLjg5NC00Ljc4NSA0LjY1OS00Ljc4NSAxLjMyNSAwIDIuNDY0LjA5NyAyLjc5Ni4xNDF2My4yNGgtMS45MjFjLTEuNSAwLTEuNzkyLjcyMS0xLjc5MiAxLjc3MXYyLjMxMWgzLjU4NGwtLjQ2NSAzLjYzSDE2LjU2VjI0aDYuMTE1Yy43MzMgMCAxLjMyNS0uNTkyIDEuMzI1LTEuMzI0VjEuMzI0QzI0IC41OTMgMjMuNDA4IDAgMjIuNjc2IDAiLz48L3N2Zz4=" alt="Facebook" style="width:1em;height:1em"/></a><a title="twitter" href="https://twitter.com"><img class="fas fa-lg" src="data:image/svg+xml;base64,PHN2ZyByb2xlPSJpbWciIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48dGl0bGU+VHdpdHRlciBpY29uPC90aXRsZT48cGF0aCBkPSJNMjMuOTU0IDQuNTY5Yy0uODg1LjM4OS0xLjgzLjY1NC0yLjgyNS43NzUgMS4wMTQtLjYxMSAxLjc5NC0xLjU3NCAyLjE2My0yLjcyMy0uOTUxLjU1NS0yLjAwNS45NTktMy4xMjcgMS4xODQtLjg5Ni0uOTU5LTIuMTczLTEuNTU5LTMuNTkxLTEuNTU5LTIuNzE3IDAtNC45MiAyLjIwMy00LjkyIDQuOTE3IDAgLjM5LjA0NS43NjUuMTI3IDEuMTI0QzcuNjkxIDguMDk0IDQuMDY2IDYuMTMgMS42NCAzLjE2MWMtLjQyNy43MjItLjY2NiAxLjU2MS0uNjY2IDIuNDc1IDAgMS43MS44NyAzLjIxMyAyLjE4OCA0LjA5Ni0uODA3LS4wMjYtMS41NjYtLjI0OC0yLjIyOC0uNjE2di4wNjFjMCAyLjM4NSAxLjY5MyA0LjM3NCAzLjk0NiA0LjgyNy0uNDEzLjExMS0uODQ5LjE3MS0xLjI5Ni4xNzEtLjMxNCAwLS42MTUtLjAzLS45MTYtLjA4Ni42MzEgMS45NTMgMi40NDUgMy4zNzcgNC42MDQgMy40MTctMS42OCAxLjMxOS0zLjgwOSAyLjEwNS02LjEwMiAyLjEwNS0uMzkgMC0uNzc5LS4wMjMtMS4xNy0uMDY3IDIuMTg5IDEuMzk0IDQuNzY4IDIuMjA5IDcuNTU3IDIuMjA5IDkuMDU0IDAgMTMuOTk5LTcuNDk2IDEzLjk5OS0xMy45ODYgMC0uMjA5IDAtLjQyLS4wMTUtLjYzLjk2MS0uNjg5IDEuOC0xLjU2IDIuNDYtMi41NDhsLS4wNDctLjAyeiIvPjwvc3ZnPg==" alt="Twitter" style="width:1em;height:1em"/></a><a title="instagram" href="https://instagram.com"><img src="data:image/svg+xml;base64,PHN2ZyByb2xlPSJpbWciIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48dGl0bGU+SW5zdGFncmFtIGljb248L3RpdGxlPjxwYXRoIGQ9Ik0xMiAwQzguNzQgMCA4LjMzMy4wMTUgNy4wNTMuMDcyIDUuNzc1LjEzMiA0LjkwNS4zMzMgNC4xNC42M2MtLjc4OS4zMDYtMS40NTkuNzE3LTIuMTI2IDEuMzg0Uy45MzUgMy4zNS42MyA0LjE0Qy4zMzMgNC45MDUuMTMxIDUuNzc1LjA3MiA3LjA1My4wMTIgOC4zMzMgMCA4Ljc0IDAgMTJzLjAxNSAzLjY2Ny4wNzIgNC45NDdjLjA2IDEuMjc3LjI2MSAyLjE0OC41NTggMi45MTMuMzA2Ljc4OC43MTcgMS40NTkgMS4zODQgMi4xMjYuNjY3LjY2NiAxLjMzNiAxLjA3OSAyLjEyNiAxLjM4NC43NjYuMjk2IDEuNjM2LjQ5OSAyLjkxMy41NThDOC4zMzMgMjMuOTg4IDguNzQgMjQgMTIgMjRzMy42NjctLjAxNSA0Ljk0Ny0uMDcyYzEuMjc3LS4wNiAyLjE0OC0uMjYyIDIuOTEzLS41NTguNzg4LS4zMDYgMS40NTktLjcxOCAyLjEyNi0xLjM4NC42NjYtLjY2NyAxLjA3OS0xLjMzNSAxLjM4NC0yLjEyNi4yOTYtLjc2NS40OTktMS42MzYuNTU4LTIuOTEzLjA2LTEuMjguMDcyLTEuNjg3LjA3Mi00Ljk0N3MtLjAxNS0zLjY2Ny0uMDcyLTQuOTQ3Yy0uMDYtMS4yNzctLjI2Mi0yLjE0OS0uNTU4LTIuOTEzLS4zMDYtLjc4OS0uNzE4LTEuNDU5LTEuMzg0LTIuMTI2QzIxLjMxOSAxLjM0NyAyMC42NTEuOTM1IDE5Ljg2LjYzYy0uNzY1LS4yOTctMS42MzYtLjQ5OS0yLjkxMy0uNTU4QzE1LjY2Ny4wMTIgMTUuMjYgMCAxMiAwem0wIDIuMTZjMy4yMDMgMCAzLjU4NS4wMTYgNC44NS4wNzEgMS4xNy4wNTUgMS44MDUuMjQ5IDIuMjI3LjQxNS41NjIuMjE3Ljk2LjQ3NyAxLjM4Mi44OTYuNDE5LjQyLjY3OS44MTkuODk2IDEuMzgxLjE2NC40MjIuMzYgMS4wNTcuNDEzIDIuMjI3LjA1NyAxLjI2Ni4wNyAxLjY0Ni4wNyA0Ljg1cy0uMDE1IDMuNTg1LS4wNzQgNC44NWMtLjA2MSAxLjE3LS4yNTYgMS44MDUtLjQyMSAyLjIyNy0uMjI0LjU2Mi0uNDc5Ljk2LS44OTkgMS4zODItLjQxOS40MTktLjgyNC42NzktMS4zOC44OTYtLjQyLjE2NC0xLjA2NS4zNi0yLjIzNS40MTMtMS4yNzQuMDU3LTEuNjQ5LjA3LTQuODU5LjA3LTMuMjExIDAtMy41ODYtLjAxNS00Ljg1OS0uMDc0LTEuMTcxLS4wNjEtMS44MTYtLjI1Ni0yLjIzNi0uNDIxLS41NjktLjIyNC0uOTYtLjQ3OS0xLjM3OS0uODk5LS40MjEtLjQxOS0uNjktLjgyNC0uOS0xLjM4LS4xNjUtLjQyLS4zNTktMS4wNjUtLjQyLTIuMjM1LS4wNDUtMS4yNi0uMDYxLTEuNjQ5LS4wNjEtNC44NDQgMC0zLjE5Ni4wMTYtMy41ODYuMDYxLTQuODYxLjA2MS0xLjE3LjI1NS0xLjgxNC40Mi0yLjIzNC4yMS0uNTcuNDc5LS45Ni45LTEuMzgxLjQxOS0uNDE5LjgxLS42ODkgMS4zNzktLjg5OC40Mi0uMTY2IDEuMDUxLS4zNjEgMi4yMjEtLjQyMSAxLjI3NS0uMDQ1IDEuNjUtLjA2IDQuODU5LS4wNmwuMDQ1LjAzem0wIDMuNjc4Yy0zLjQwNSAwLTYuMTYyIDIuNzYtNi4xNjIgNi4xNjIgMCAzLjQwNSAyLjc2IDYuMTYyIDYuMTYyIDYuMTYyIDMuNDA1IDAgNi4xNjItMi43NiA2LjE2Mi02LjE2MiAwLTMuNDA1LTIuNzYtNi4xNjItNi4xNjItNi4xNjJ6TTEyIDE2Yy0yLjIxIDAtNC0xLjc5LTQtNHMxLjc5LTQgNC00IDQgMS43OSA0IDQtMS43OSA0LTQgNHptNy44NDYtMTAuNDA1YzAgLjc5NS0uNjQ2IDEuNDQtMS40NCAxLjQ0LS43OTUgMC0xLjQ0LS42NDYtMS40NC0xLjQ0IDAtLjc5NC42NDYtMS40MzkgMS40NC0xLjQzOS43OTMtLjAwMSAxLjQ0LjY0NSAxLjQ0IDEuNDM5eiIvPjwvc3ZnPg==" alt="Instagram" style="width:1em;height:1em"/></a><a title="vimeo" href="https://vimeo.com"><img src="data:image/svg+xml;base64,PHN2ZyByb2xlPSJpbWciIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48dGl0bGU+VmltZW8gaWNvbjwvdGl0bGU+PHBhdGggZD0iTTIzLjk3NyA2LjQxNmMtLjEwNSAyLjMzOC0xLjczOSA1LjU0My00Ljg5NCA5LjYwOS0zLjI2OCA0LjI0Ny02LjAyNiA2LjM3LTguMjkgNi4zNy0xLjQwOSAwLTIuNTc4LTEuMjk0LTMuNTUzLTMuODgxTDUuMzIyIDExLjRDNC42MDMgOC44MTYgMy44MzQgNy41MjIgMy4wMSA3LjUyMmMtLjE3OSAwLS44MDYuMzc4LTEuODgxIDEuMTMyTDAgNy4xOTdjMS4xODUtMS4wNDQgMi4zNTEtMi4wODQgMy41MDEtMy4xMjhDNS4wOCAyLjcwMSA2LjI2NiAxLjk4NCA3LjA1NSAxLjkxYzEuODY3LS4xOCAzLjAxNiAxLjEgMy40NDcgMy44MzguNDY1IDIuOTUzLjc4OSA0Ljc4OS45NzEgNS41MDcuNTM5IDIuNDUgMS4xMzEgMy42NzQgMS43NzYgMy42NzQuNTAyIDAgMS4yNTYtLjc5NiAyLjI2NS0yLjM4NSAxLjAwNC0xLjU4OSAxLjU0LTIuNzk3IDEuNjEyLTMuNjI4LjE0NC0xLjM3MS0uMzk1LTIuMDYxLTEuNjE0LTIuMDYxLS41NzQgMC0xLjE2Ny4xMjEtMS43NzcuMzkxIDEuMTg2LTMuODY4IDMuNDM0LTUuNzU3IDYuNzYyLTUuNjM3IDIuNDczLjA2IDMuNjI4IDEuNjY0IDMuNDkzIDQuNzk3bC0uMDEzLjAxeiIvPjwvc3ZnPg==" alt="Vimeo" style="width:1em;height:1em"/></a></div></div></div></div></footer></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/2019-07-21-lets-talk-to-AD/";window.webpackCompilationHash="a7a5cb34354c072d4284";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-c854117d53b9eb1ae65e.js"],"component---src-templates-about-page-js":["/component---src-templates-about-page-js-a90af558abe560261023.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-7f8a571ae5734db95f50.js"],"component---src-templates-index-page-js":["/component---src-templates-index-page-js-c7ffd30047a0d6ac9b89.js"],"component---src-templates-tags-js":["/component---src-templates-tags-js-58753518b1294869dc00.js"],"component---src-pages-404-js":["/component---src-pages-404-js-2f633df377b3e13ee7a7.js"],"component---src-pages-blog-index-js":["/component---src-pages-blog-index-js-a454ba7c2a7d0ec22845.js"],"component---src-pages-contact-examples-js":["/component---src-pages-contact-examples-js-84e0614c8b2451dfcd2b.js"],"component---src-pages-contact-file-upload-js":["/component---src-pages-contact-file-upload-js-906296f01d0120189a78.js"],"component---src-pages-contact-index-js":["/component---src-pages-contact-index-js-d1dd07719057db72a524.js"],"component---src-pages-contact-thanks-js":["/component---src-pages-contact-thanks-js-bd1040bbf91fd4933e10.js"],"component---src-pages-tags-index-js":["/component---src-pages-tags-index-js-a04a33ac9188bb5ba97a.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-7f8a571ae5734db95f50.js" async=""></script><script src="/2-9e3778d7061052ade4c2.js" async=""></script><script src="/1-be23e6ea5d5e37b03898.js" async=""></script><script src="/styles-65d0eb307115056d1679.js" async=""></script><script src="/app-c854117d53b9eb1ae65e.js" async=""></script><script src="/webpack-runtime-d2d979d476131837bff3.js" async=""></script></body></html>