{"componentChunkName":"component---src-templates-blog-post-js","path":"/a-lost-cors/","result":{"data":{"site":{"siteMetadata":{"title":"Occasional Blog","author":"Daniel Betteridge"}},"mdx":{"id":"f23c5c13-2de1-54e7-8c1f-6c22106bba1f","excerpt":"I recently decided that I wanted to practice using a few of the browsers API's to try and build something on 3rd party API's rather then always building my ownâ€¦","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"templateKey\": \"blog-post\",\n  \"title\": \"A Lost CORS?\",\n  \"date\": \"2020-08-18T15:04:10.000Z\",\n  \"featuredpost\": false,\n  \"featuredImage\": \"./stop-lizard.jpg\",\n  \"cover\": \"./stop-lizard.jpg\",\n  \"description\": \"CORS, PWA's and frustration\",\n  \"tags\": [\"javascript\", \"pwa\", \"cors\", \"security\", \"suffering\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"I recently decided that I wanted to practice using a few of the browsers API\\u2019s to try and build something on 3rd party API\\u2019s rather then always building my own right off the bat.\"), mdx(\"p\", null, \"I\\u2019ll build a podcast app! that\\u2019s something you can do easily in the browser I thought.\"), mdx(\"p\", null, \"IndexedDB to store the metadata and cache the audio files and images, Service-Workers to pre-load content and make things work nicely offline.\"), mdx(\"h2\", null, \"Roadblock\"), mdx(\"p\", null, \"Pretty much as soon as I had setup the basic app skeleton I wanted to try and load my first RSS feed, get some podcast links and play some audio.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"512px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/600084f73795f3ad78e174be3adc9c42/01e7c/stop-sign.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"100%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAWeCAAFnggHHN5GLAAACkklEQVQ4y3WVTYjNURTA7/2f+xqzUaSIpJ6UFFMkC5IpUihJdkphp5RIrCwxPgYxZmPUjK+FleHJ1IzCvORjg5TNYGNLYyfT+J17z31ze5n3+v3P/d977rnnno/3nDhx1Qw+vvvQom09kr9x3QcvSbr4yS8oVKa4HsVxaDJustasDEno2msYYbxU2o1GE6VHPrxHfsOT89DH+DoaCR9uQB/jC6z9Zu2BeS2V2ckGxU44BNPMLGl5Pjubo64Pm+xdkkF1N5nthEnee0yhQ5Xi6UlZzBMd10znMXs+FreLHmbvLsFP6LSYShHfeI9WvHhacurIaYwdNKOS3a/bVQ/krFpck3ckLM8VSeiw8VmYRG+O6uSNDdQ/WJl0w1vmjyGvID/DGTgBr5hbgTwJnyw5gfEv5MV4ZQZb1TuMbTTjj2zDIGvbNeuwDZ5Cf5UOuYqx08gXlZabD/stQXX18CtG7hRXeqgexZg4WczsMHIV3I4h8eEanGOschzmFeU2ooN30CgMasmMgRrQwn2G7EIOIY8ge2MCnUwgj0o6WPd9gfv60mXu7raM7qmS0aYZGoa1cA8Oo38TeRm2tCrAh1PMT6m3uVcHePlhpaCB1vEt5pbBSw6Yi3wCExavfvT2mncLkVPI45KzDPPhr2bSWmmHJCMBYxuKUHSbV6vRWWS6g5Ja1eVOEQuqloW6vaC9zaqi+YtrKussXDtz+81sSkrfeQ7Zhg7rz5rJgE7NCr1m+m94jpqnVauwW23mZFesSSdrZJbfwqIa9om2nZOVNlflKydFJuzqDfgTG9+H5zDaxpgVubZqb+5hKWLoyhNgOQzEuqNbTJbo3F39fWRfLmpvTrkywOkvoD34//sWP8hVkQP9/AMeEHnKoYo9YwAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"STOP\",\n    \"title\": \"STOP\",\n    \"src\": \"/static/600084f73795f3ad78e174be3adc9c42/01e7c/stop-sign.png\",\n    \"srcSet\": [\"/static/600084f73795f3ad78e174be3adc9c42/12f09/stop-sign.png 148w\", \"/static/600084f73795f3ad78e174be3adc9c42/e4a3f/stop-sign.png 295w\", \"/static/600084f73795f3ad78e174be3adc9c42/01e7c/stop-sign.png 512w\"],\n    \"sizes\": \"(max-width: 512px) 100vw, 512px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"This is the point I learnt that a lot of podcasts are not served with CORS headers, even Google\\u2019s feedproxy.google.com does not return CORS headers!\"), mdx(\"p\", null, \"For anyone who has ever tried to setup their first API, CORS is one of those annoyances you run into almost immediately when trying to do so\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"Me: I just want to get some JSON!\")), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"Browser: this has been blocked by CORS policy: No \\u2018Access-Control-Allow-Origin\\u2019 header is present on the requested resource.\")), mdx(\"p\", null, \"When you run your own server this is an easily solvable problem, when you get sent an HTTP request simply include\"), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Access-Control-Allow-Origin: *\"), \" and\"), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept\")), mdx(\"p\", null, \"headers in your response, the values of these vary by your setup but these are fine as basic setup.\"), mdx(\"p\", null, \"Unfortunately you cannot force 3rd party server owners to enable these, so you need either setup a proxy (Can get expensive) or only support content that does return those headers (Very limited range!)\"), mdx(\"h2\", null, \"Options\"), mdx(\"p\", null, \"If you have a link to the audio file, you can just put this straight into an \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"<audio>\"), \" element and it will be playable.\"), mdx(\"b\", null, \"But\"), \" you cannot access that data from javascript, so no caching it into IndexedDB or doing any sort of browser side audio improvements.\", mdx(\"p\", null, \"You can request the resource with \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"mode: 'no-cors'\"), \" which a Service-Worker is still able to cache the resulting data, but you cannot access this data outside of just serving it up to the \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"<audio>\"), \" element as discussed above, this allows offline to work and is an improvement but still not at the level of a \\u2018Native\\u2019 application.\"), mdx(\"h2\", null, \"Whats next?\"), mdx(\"p\", null, \"Well for now my project is on the back-burner, I\\u2019ve begun the process of implementing my own API to handle indexing RSS feeds, Retrieving and caching media from the various podcast sources,\\nbut the initial piece of work I wanted to do to learn about browser API\\u2019s is unfortunately hobbled by CORS and mixed-content issues.\"), mdx(\"p\", null, \"I\\u2019m told the best way to find out the answer to a question is post the wrong one online, So I hope that if there is a way around these issues someone reads this and can tell me.\"), mdx(\"h2\", null, \"Solutions\"), mdx(\"p\", null, \"Could we have some kind of CORS/Mixed Content proxy that is only accessible to installed PWA\\u2019s ?\"), mdx(\"p\", null, \"I\\u2019ll leave it up to someone with more experience in the browser security model to tell me why that won\\u2019t work the way I think.\"), mdx(\"h2\", null, \"Further Reading\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://aerotwist.com/blog/cors-for-concern/\"\n  }, \"Paul\\u2019s great prior article - 2015\")));\n}\n;\nMDXContent.isMDXComponent = true;","fields":{"slug":"/a-lost-cors/","socialcard":"social-card-f23c5c13-2de1-54e7-8c1f-6c22106bba1f.jpg"},"frontmatter":{"title":"A Lost CORS?","date":"August 18, 2020","description":"CORS, PWA's and frustration"}}},"pageContext":{"slug":"/a-lost-cors/","previous":{"fields":{"slug":"/dont-feed-after-midnight/"},"frontmatter":{"title":"Don't feed them after midnight"}},"next":{"fields":{"slug":"/honeymoon/"},"frontmatter":{"title":"Honeymoon Part 1"}}}},"staticQueryHashes":["3537562275","426816048"]}